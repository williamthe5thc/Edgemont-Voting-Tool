import React, { useState, useEffect } from 'react';

const Preloader = ({ onLoadComplete }) => {
  const [progress, setProgress] = useState(0);
  const [showLoader, setShowLoader] = useState(true);

  useEffect(() => {
    const timer = setInterval(() => {
      setProgress((prev) => {
        const newProgress = prev < 100 ? prev + 1 : prev;
        if (newProgress === 100) {
          setTimeout(() => {
            setShowLoader(false);
            if (onLoadComplete) {
              onLoadComplete();
            }
          }, 500);
          clearInterval(timer);
        }
        return newProgress;
      });
    }, 30);

    return () => clearInterval(timer);
  }, [onLoadComplete]);

  if (!showLoader) return null;

  // Calculate height and position of white overlay based on progress
  const overlayHeight = 524.22 * (progress / 100);
  const overlayY = 524.22 - overlayHeight;

  return (
    <div className="flex flex-col items-center justify-center min-h-screen bg-[#2C0735]">
      <div className="max-w-xl w-full px-6 text-center">
        <p className="text-white mb-8 text-lg">
          Loading the Edgemont 1st Ward Dia de Los Ancestros Cooking Competition Voting Tool...
        </p>
        
        <div className="relative w-96 h-96 mx-auto mb-8">
          <svg 
            viewBox="0 0 344.94 524.22"
            className="w-full h-full"
            aria-label="Sugar Skull Loading Animation"
          >
            {/* Sugar Skull Main Path */}
            <path 
              fill="#FFFFFF"
              d="M331.53,187.7c-1.39-29.44-8.29-58.85-19.73-86.09-11.5-27.39-28.47-51.21-54.42-67.06C217.97,10.48,169.9,4.03,125.29,16.68c-19.2,5.44-36.41,16.19-50.95,29.51C31.85,85.09,19.19,135.42,16.39,190.54c-.72,14.22-4.37,34.56,5.6,46.6,10.22,12.35,35.05,16.84,49.5,22.32,20.83,7.9,41.19,22.3,48.51,43.97,6.09,18.03,4.16,39.17,1.59,57.67-.79,5.7-1.76,11.38-2.82,17.04,8.47.41,17.34,1.74,24.52,1.61,11.94-.22,23.87-.3,35.81.19,11.45.47,22.8.25,34.25-.07,5.04-.14,11.01-.81,16.68-.5-.4-4.94-.76-9.88-1.08-14.82-1.56-24.54-7.82-54.76,8.01-75.48,12.6-16.48,31.72-25.38,49.16-35.72,12.01-7.12,27.39-14.39,35.57-25.52,8.6-11.7,10.5-26.05,9.84-40.15Z"
            />
            {/* Decorative Details - copied from your SVG */}
            <path d="M284.05,158.21c6.86-2.2,13.12-7.05,12.39-13.58-1.15-10.27-11.64-12.93-20.54-10.75,6.88-3.51,10.14-13.57,6.33-20.01-3.56-6.01-12.84-4.91-18.71-1.16,2.74-6.79.39-16.64-4.82-20.62-7.32-5.59-16.95-.23-20.05,7.17-.46-.66-.96-1.25-1.5-1.72-2.48-2.16-7.43-3.38-10.55-2.48-5.28,1.52-8.39,7.97-6.16,13.06-4.96-3.8-12.6-4.68-16.3.84-4.22,6.3.48,13.58,6.23,18.4-5.41-.6-12.74.44-14.18,4.12-3.11,7.93,5.17,11.89,11.31,13.82-2.75.22-5.61,1.03-7.76,1.94-3.55,1.5-7.1,4.08-7.04,8.02.07,5.02,4.39,8.42,9.26,9.48-1.3.58-2.5,1.26-3.5,1.99-3.76,2.75-7.4,6.79-6.75,11.4,1.02,7.25,8.88,9.3,15.47,7.8-2.26,1.7-4.19,4.12-5.26,5.89-2.58,4.29-5.05,9.9-2.87,14.56,3.22,6.89,11.7,7.66,17.6,4.15-1.75,5.87-.32,13.46,3.72,16.71,6.74,5.43,15.31,1.45,18.34-5.31.81,2.29,2.12,4.46,3.47,6.03,3.25,3.77,8.34,6.89,13.25,5.34,7.22-2.27,8.2-10.4,6.19-17.09,6.65,4.35,16.78,5.53,19.91-2.18,1.34-3.32.35-8.45-2.07-12.44,5.09,1.48,10.34,1.16,12.5-3.57,2.75-6.04-1.5-13.64-7.47-17.45,6.31-.78,11.82-4.34,11.43-11.43-.39-7.11-5.77-10.42-11.86-10.95Z"/>
            
 <path d="M284.05,158.21c6.86-2.2,13.12-7.05,12.39-13.58-1.15-10.27-11.64-12.93-20.54-10.75,6.88-3.51,10.14-13.57,6.33-20.01-3.56-6.01-12.84-4.91-18.71-1.16,2.74-6.79.39-16.64-4.82-20.62-7.32-5.59-16.95-.23-20.05,7.17-.46-.66-.96-1.25-1.5-1.72-2.48-2.16-7.43-3.38-10.55-2.48-5.28,1.52-8.39,7.97-6.16,13.06-4.96-3.8-12.6-4.68-16.3.84-4.22,6.3.48,13.58,6.23,18.4-5.41-.6-12.74.44-14.18,4.12-3.11,7.93,5.17,11.89,11.31,13.82-2.75.22-5.61,1.03-7.76,1.94-3.55,1.5-7.1,4.08-7.04,8.02.07,5.02,4.39,8.42,9.26,9.48-1.3.58-2.5,1.26-3.5,1.99-3.76,2.75-7.4,6.79-6.75,11.4,1.02,7.25,8.88,9.3,15.47,7.8-2.26,1.7-4.19,4.12-5.26,5.89-2.58,4.29-5.05,9.9-2.87,14.56,3.22,6.89,11.7,7.66,17.6,4.15-1.75,5.87-.32,13.46,3.72,16.71,6.74,5.43,15.31,1.45,18.34-5.31.81,2.29,2.12,4.46,3.47,6.03,3.25,3.77,8.34,6.89,13.25,5.34,7.22-2.27,8.2-10.4,6.19-17.09,6.65,4.35,16.78,5.53,19.91-2.18,1.34-3.32.35-8.45-2.07-12.44,5.09,1.48,10.34,1.16,12.5-3.57,2.75-6.04-1.5-13.64-7.47-17.45,6.31-.78,11.82-4.34,11.43-11.43-.39-7.11-5.77-10.42-11.86-10.95ZM282.78,135.87c5.22.77,9.81,5.39,9.29,10.83-.63,6.7-8.11,8.69-14.42,10.03-.09-.65-.18-1.3-.28-1.94-.8-5.08-2.45-11.22-4.83-17.46,3.25-1.3,6.83-1.97,10.24-1.46ZM271.75,135.3c-.03-.07-.06-.14-.08-.21.27-.02.53-.05.79-.09-.24.1-.48.2-.71.3ZM278.26,114.58c2.39,3.41,2.23,8.74.41,12.34-1.73,3.42-4.6,4.85-7.9,6.06-2.46-5.66-5.51-11.2-9.04-15.93,4.42-3.38,12.48-8.24,16.53-2.47ZM258.38,96.9c3.51,5.09,4.1,12.25,1.52,17.84-2.89-3.46-6.06-6.35-9.48-8.3-3.51-2.01-6.82-2.87-9.91-2.84-.14-.62-.32-1.23-.56-1.82,3.08-7.69,12.36-13.68,18.42-4.88ZM222.66,102.28c1.15-2.22,3.51-3.62,5.9-4.2,2.48-.6,5.17-.28,7.07,1.52,1.32,1.26,1.76,2.72,2,4.24,0,.02,0,.03,0,.05-4.95.98-9.32,4.27-13.08,8.78-1.35-3.06-3.25-7.77-1.89-10.39ZM224.28,113s-.02.03-.03.04c0-.02,0-.05,0-.07,0,0,.02.02.02.03ZM206.07,113.84c1.91-8.53,12.87-5.4,17.2.01.13.01.25,0,.37-.05-.07.09-.14.17-.2.26-.05-.07-.11-.14-.16-.21-.12-.01-.25-.04-.36-.12l.44.44c-3.05,3.99-5.67,8.75-7.86,13.63-4.66-3.6-10.8-7.79-9.42-13.97ZM199.26,133.58c2.67-5.02,10.22-4.15,15.09-3.12-1.99,4.79-3.56,9.58-4.72,13.77-4.33-2.04-13.68-4.45-10.37-10.66ZM196.44,153.36c1.83-4.8,7.47-4.71,12.17-5.16-.2.85-.38,1.67-.54,2.43-.78,3.83-1.38,7.93-1.73,12.16-1.82.13-3.66-.09-5.39-.79-3.45-1.39-5.94-4.92-4.52-8.64ZM195.67,177.19c-.18-4.3,2.4-7.73,6.24-9.56,1.37-.65,2.78-.98,4.2-1.22-.27,5.78-.05,11.71.85,17.48-5.29.96-11.02-.3-11.29-6.7ZM202.18,203.65c-1.25-3.93.14-8.14,2.44-11.44.9-1.29,2-2.5,3.25-3.5,1.59,6.99,4.28,13.57,8.41,19.12-5.01,3.27-11.85,2.95-14.1-4.18ZM231.23,225.99c-4.13,1.39-8.82-.79-10.89-4.43-1.98-3.47-1.58-6.59-.57-9.7,4.64,4.57,10.59,7.7,16.86,9.1-1.06,2.27-2.81,4.16-5.4,5.03ZM254.57,229.36c-4.56,1.47-8.86-.87-11.32-4.63-.65-1-1.07-2-1.4-3.01,6.12.41,12.27-.86,17.54-4.06,1.04,4.83.3,10.06-4.82,11.71ZM278.2,211.7c-1.34,4.29-6.9,5.41-10.82,4.32-1.35-.37-2.52-.97-3.6-1.69.68-.63,1.34-1.29,1.96-2,3.35-3.81,5.93-8.29,7.87-13.14,3.7,2.64,5.79,8.67,4.59,12.51ZM286.79,186.78c2.17,3.11,4.01,8.55.48,11.48-3.34,2.77-8.28.56-12.54-1.46-.06-.03-.12-.07-.18-.1,1.79-5.14,2.92-10.63,3.52-16.18,3.57.74,6.71,3.36,8.73,6.26ZM291.95,170.59c-.45,7.73-7.64,6.92-13.64,7.11.44-5.77.32-11.54-.19-16.96,6.88-.86,14.32,1.55,13.83,9.85Z"/>
    <path d="M222.91,113.73l-.3-.3c.09.13.19.23.3.3Z"/>
  </g>
  <path class="cls-1" d="M147.93,430.11c4.54,12.01,14.41,3.25,18.17-4.82,4.03-8.65,6.19-18.04,6.88-27.51.01-1.54.05-3.04.1-4.46-9.43-.24-18.87-.27-28.31-.2.15,12.34-1.21,25.45,3.15,36.99Z"/>
             
            {/* Progress overlay - this will cover the skull from bottom to top */}
            <rect
              x="0"
              y={overlayY}
              width="344.94"
              height={overlayHeight}
              fill="white"
              className="transition-all duration-300"
            />
          </svg>
        </div>

        <p className="text-white font-medium">{progress}%</p>

        <div className="bg-purple-900/50 border border-yellow-400 rounded-lg p-6 mb-6">
          <h2 className="text-xl text-white mb-4">Voting Instructions</h2>
          <ul className="text-white text-left space-y-2">
            <li>For each category, select up to 2 of your favorite dishes.</li>
            <li>Enter the number associated with the dish in each category you want to vote for.</li>
            <li>You can select either one, two or no dishes per category.</li>
          </ul>
        </div>
      </div>
    </div>
  );
};

export default Preloader;
