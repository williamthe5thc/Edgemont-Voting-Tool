import React, { useState, useEffect } from 'react';

const Preloader = ({ onLoadComplete }) => {
  const [progress, setProgress] = useState(0);
  const [showLoader, setShowLoader] = useState(true);

  useEffect(() => {
    const timer = setInterval(() => {
      setProgress((prev) => {
        const newProgress = prev < 100 ? prev + 1 : prev;
        if (newProgress === 100) {
          setTimeout(() => {
            setShowLoader(false);
            if (onLoadComplete) {
              onLoadComplete();
            }
          }, 500);
          clearInterval(timer);
        }
        return newProgress;
      });
    }, 30);

    return () => clearInterval(timer);
  }, [onLoadComplete]);

  if (!showLoader) return null;

  // Calculate height and position of white overlay based on progress
  const overlayHeight = 524.22 * (progress / 100);
  const overlayY = 524.22 - overlayHeight;

  return (
    <div className="flex flex-col items-center justify-center min-h-screen bg-[#2C0735]">
      <div className="max-w-xl w-full px-6 text-center">
        <p className="text-white mb-8 text-lg">
          Loading the Edgemont 1st Ward Dia de Los Ancestros Cooking Competition Voting Tool...
        </p>
        
        <div className="relative w-96 h-96 mx-auto mb-8">
         <svg 
  viewBox="0 0 344.94 524.22"
  className="w-full h-full"
  aria-label="Sugar Skull Loading Animation"
>
  <defs>
    <style>
      {`.cls-1 {
        fill: #fff;
        stroke: #000;
        stroke-width: 0.5px;
      }
      path:not(.cls-1) {
        fill: none;
        stroke: #000;
        stroke-width: 0.5px;
      }`}
    </style>
  </defs>

  <path class="cls-1" d="M331.53,187.7c-1.39-29.44-8.29-58.85-19.73-86.09-11.5-27.39-28.47-51.21-54.42-67.06C217.97,10.48,169.9,4.03,125.29,16.68c-19.2,5.44-36.41,16.19-50.95,29.51C31.85,85.09,19.19,135.42,16.39,190.54c-.72,14.22-4.37,34.56,5.6,46.6,10.22,12.35,35.05,16.84,49.5,22.32,20.83,7.9,41.19,22.3,48.51,43.97,6.09,18.03,4.16,39.17,1.59,57.67-.79,5.7-1.76,11.38-2.82,17.04,8.47.41,17.34,1.74,24.52,1.61,11.94-.22,23.87-.3,35.81.19,11.45.47,22.8.25,34.25-.07,5.04-.14,11.01-.81,16.68-.5-.4-4.94-.76-9.88-1.08-14.82-1.56-24.54-7.82-54.76,8.01-75.48,12.6-16.48,31.72-25.38,49.16-35.72,12.01-7.12,27.39-14.39,35.57-25.52,8.6-11.7,10.5-26.05,9.84-40.15Z"/>

  <g>
    <path d="M284.05,158.21c6.86-2.2,13.12-7.05,12.39-13.58-1.15-10.27-11.64-12.93-20.54-10.75,6.88-3.51,10.14-13.57,6.33-20.01-3.56-6.01-12.84-4.91-18.71-1.16,2.74-6.79.39-16.64-4.82-20.62-7.32-5.59-16.95-.23-20.05,7.17-.46-.66-.96-1.25-1.5-1.72-2.48-2.16-7.43-3.38-10.55-2.48-5.28,1.52-8.39,7.97-6.16,13.06-4.96-3.8-12.6-4.68-16.3.84-4.22,6.3.48,13.58,6.23,18.4-5.41-.6-12.74.44-14.18,4.12-3.11,7.93,5.17,11.89,11.31,13.82-2.75.22-5.61,1.03-7.76,1.94-3.55,1.5-7.1,4.08-7.04,8.02.07,5.02,4.39,8.42,9.26,9.48-1.3.58-2.5,1.26-3.5,1.99-3.76,2.75-7.4,6.79-6.75,11.4,1.02,7.25,8.88,9.3,15.47,7.8-2.26,1.7-4.19,4.12-5.26,5.89-2.58,4.29-5.05,9.9-2.87,14.56,3.22,6.89,11.7,7.66,17.6,4.15-1.75,5.87-.32,13.46,3.72,16.71,6.74,5.43,15.31,1.45,18.34-5.31.81,2.29,2.12,4.46,3.47,6.03,3.25,3.77,8.34,6.89,13.25,5.34,7.22-2.27,8.2-10.4,6.19-17.09,6.65,4.35,16.78,5.53,19.91-2.18,1.34-3.32.35-8.45-2.07-12.44,5.09,1.48,10.34,1.16,12.5-3.57,2.75-6.04-1.5-13.64-7.47-17.45,6.31-.78,11.82-4.34,11.43-11.43-.39-7.11-5.77-10.42-11.86-10.95Z"/>
    <path d="M222.91,113.73l-.3-.3c.09.13.19.23.3.3Z"/>
  </g>

  <path class="cls-1" d="M147.93,430.11c4.54,12.01,14.41,3.25,18.17-4.82,4.03-8.65,6.19-18.04,6.88-27.51.01-1.54.05-3.04.1-4.46-9.43-.24-18.87-.27-28.31-.2.15,12.34-1.21,25.45,3.15,36.99Z"/>
  <path class="cls-1" d="M217.44,423.44c9.87,3.98,12.29-23.87,12.82-29.98-6.27.3-12.85-.35-18.62-.15-1.53.05-3.05.09-4.57.13.09.79.16,1.62.2,2.48.78,8.29,3.53,24.83,10.18,27.51Z"/>
  <path class="cls-1" d="M179.38,393.49c-.01,8.95.42,24.24,9.48,24.74,13.15.73,11.55-22.97,11.6-24.62-7.02.13-14.04.13-21.09-.12Z"/>
  <path class="cls-1" d="M219.01,433.75c-7.66-.28-13.65-13.63-14.84-23.97-1.2,10.34-7.21,19.4-14.12,19.27-6.93-.13-13.89-7.28-14.12-18.33-.24,7.75-3.92,19.27-6.94,24.2-4.34,7.09-12.85,13.6-21.46,9.26-8.21-4.14-9.09-17.44-9.92-25.46-.19-1.86.59-10.38.5-12.23-4.07,12.92-11.28,20.88-18.67,19.5-5.05-.94-7.72-4.18-8.89-8.41-.4,1.89-.8,3.78-1.18,5.67-2.46,12.1-5.49,26.3.41,37.93,4.22,8.31,12.6,13.52,19.55,19.5,12.38,10.64,32.01,25.68,46.65,28.72,13.13-4.92,26.17-15.22,35.67-24.85,10.45-10.6,23.19-24.95,24.42-40.35.71-8.87-.38-17.87-1.65-26.75-2.46,9.02-7.24,16.6-15.39,16.3Z"/>
  <path class="cls-1" d="M136.29,393.27c-5.3.19-10.76.5-16.15.38-2.47,7.05-6.03,18.92.85,21.6,8.77,3.41,13.69-12.18,15.29-21.98Z"/>
  <path d="M191.64,253.37c-7.66-18.8-20.85-47.32-22.34-43.86-7.98,18.48-12.77,29.14-20.75,52.32-4.42,12.83-10.77,28.92-7.54,42.67,2.52,10.74,13.36,10.21,20.97,4.21,4.2-3.31,9.61-12.37,10.9-21.47.98,5.81,2.79,10.86,3.6,12.5,3.16,6.41,7.66,14.2,14.65,17.24,11.81,5.13,13.11-11.01,12.79-18.45-.64-14.71-6.73-31.55-12.27-45.15Z"/>
  
  <path d="M38.58,155.64c1.21-1.28,3.63-.64,4.45.45.52.69.59,1.77.54,2.56-.19,3.52-3.44,4.51-6.3,3.63-4.23-1.29-5.73-6.01-5.86-9.91-.24-6.71,2.63-13.72,5.88-19.49,7.89-14.01,20.59-24.57,32.42-35.2,7.58-6.81,16.19-19.22,6.4-27.98-7.06-6.32-20.57-1.95-18.52,8.68,1.57,8.13,15.93,6.73,13.6-1.86-.51-1.89-3.54-1.53-3.5.46.06,2.31-1.63,3.68-4.01,3.1-4.21-1.02-2.56-6.54-.16-8.55,2.99-2.5,7.17-1.74,9.83.85,3.21,3.12,3.66,6.86,2.05,10.85-2.48,6.15-7.64,10.74-12.7,14.87-6.3,5.15-12.33,10.71-17.71,16.79-8.35,9.43-16.38,20.38-18.04,33.13-.63,4.81-.29,10.2,2.91,14.14,2.83,3.48,7.73,5.55,12.09,3.58,9.99-4.51,1.46-19.59-5.32-12.02-1.16,1.29.73,3.19,1.94,1.91h0Z"/>
  <path d="M146.88,221.14c-1.27,5.52-2.89,10.98-7.9,14.34-3.87,2.59-8.62,3.52-13.21,3.9-8.2.67-17.16-1.03-25.1,1.61-8.97,2.98-12.76,14.69-4.64,20.78,11.19,8.39,28.12,1.74,37.76-5.84,10.8-8.49,17.26-20.16,16.14-33.96-.18-2.27-3.36-2.25-3.57,0-.57,5.89-.28,11.78-2.98,17.24-2.05,4.15-5.43,7.89-8.76,11.09-5.51,5.3-12.69,9.31-20.27,10.84-5.98,1.21-16.78,1.07-18.93-6.27-1.41-4.82,2.87-9.27,7.21-10.51,3.32-.95,6.87-.98,10.3-1.05,7.38-.15,15.25.1,22.29-2.41,8.54-3.05,13.42-10.7,14.24-19.4.14-1.45-2.25-1.75-2.58-.34h0Z"/>

  <path class="cls-1" d="M216.81,160.06c-.76,3.54-1.34,7.19-.74,10.76.6,3.57,2.56,7.07,5.8,8.79,2.97,1.57,6.55,1.46,9.88.96,2.04-.3,4.07-.74,5.95-1.56,6.46-2.82,10.24-10.41,8.84-17.22-3.12-15.14-26.24-17.91-29.74-1.73Z"/>
  <path class="cls-1" d="M107.7,148.24c-3.52.55-6.54,3.33-8.27,6.74-1.74,3.41-2.34,7.38-2.44,11.29-.07,2.49.07,5.05.99,7.34,2.32,5.8,8.79,8.06,14.55,8.29,2.78.11,5.7-.13,8.05-1.74,1.46-1,2.61-2.47,3.5-4.07,2.45-4.39,3.03-9.98,1.54-14.86-2.29-7.52-10.5-14.14-17.92-12.97Z"/>

  {/* Progress overlay */}
  <rect
    x="0"
    y={overlayY}
    width="344.94"
    height={overlayHeight}
    fill="white"
    className="transition-all duration-300"
  />
</svg>
        </div>

        <p className="text-white font-medium">{progress}%</p>

        <div className="bg-purple-900/50 border border-yellow-400 rounded-lg p-6 mb-6">
          <h2 className="text-xl text-white mb-4">Voting Instructions</h2>
          <ul className="text-white text-left space-y-2">
            <li>For each category, select up to 2 of your favorite dishes.</li>
            <li>Enter the number associated with the dish in each category you want to vote for.</li>
            <li>You can select either one, two or no dishes per category.</li>
          </ul>
        </div>
      </div>
    </div>
  );
};

export default Preloader;
